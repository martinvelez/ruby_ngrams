#!/usr/bin/ruby -w

require File.expand_path(File.join(File.dirname(__FILE__), "..", "lib", "ruby_ngrams"))
require File.expand_path(File.join(File.dirname(__FILE__), "..", "lib", "ruby_cli"))

if __FILE__ == $0

	app = RubyCLI.new(ARGV, __FILE__, false)
	app.arguments({:files => {:val => ARGF, :required => false}})
	app.add_option(:n => ['-n NUM', Integer, 'set length n for n-grams'])
	app.add_option(:unit => ['-u','--unit UNIT',["char","word","line"], 'select unit type'])

	#This is the actual command of this CLI app
	# A CLI app should not have to validate options and arguments.
	# This work needs to be delegated to the library that will use
	# the options and arguments.
	# A CLI app needs to run command instructions which call at 
	# least one class or library to do the actual work.
	app.command = Proc.new do |options, arguments|
		text = arguments[:files][:val].read
		ngrams = Ngrams::extract(text, options[:n], options[:unit])
		puts ngrams
	end
	
	exit app.run
	
	ngrams = Ngrams::extract(input, n, unit)

end
